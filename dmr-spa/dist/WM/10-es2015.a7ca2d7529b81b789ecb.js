(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{bBuA:function(e,t,i){"use strict";i.r(t),i.d(t,"HttpLoaderFactory",function(){return Le}),i.d(t,"ReportModule",function(){return Fe});var n=i("ofXK"),a=i("3Pt+"),l=i("JqCM"),r=i("ZOsW"),s=i("jcQU"),o=i("1kSV"),c=i("uF4Q"),d=i("0jTc"),u=i("SRvG"),g=i("ed8r"),h=i("QYJQ"),b=i("tk/3"),p=i("sYmb"),m=i("mqiu"),f=i("Pk9d"),S=i("cZdB"),D=i("GJ+o"),y=i("4SUy"),w=i("hXFv"),C=i("QUNt"),v=i("z+xu"),x=i("ZwAT"),I=i("0hV+"),B=i("tyNb"),R=i("mrSG"),M=i("fXoL"),A=i("0go6"),N=i("h9f+");const T=["grid"];function U(e,t){if(1&e&&M.Kc(0),2&e){const e=t.$implicit,i=M.gc();M.Mc(" ",i.NO(e.index)," ")}}function k(e,t){1&e&&M.Kc(0),2&e&&M.Mc("",t.$implicit.qty," kg")}let O=(()=>{class e{constructor(e,t){this.makeGlueService=e,this.buildingUserService=t,this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10}}ngOnInit(){this.filterSettings={type:"Excel"},this.toolbarOptions=["Excel Export","Search"],this.loadData()}toolbarClick(e){switch(e.item.text){case"Excel Export":this.grid.excelExport()}}getUsers(){return new Promise((e,t)=>{this.buildingUserService.getAllUsers(1,1e3).subscribe(t=>{const i=t.result.map(e=>({ID:e.ID,EmployeeID:e.EmployeeID,Email:e.Email}));this.users=i,e(!0)},e=>{t(!1)})})}username(e){var t;return(null===(t=this.users.find(t=>t.ID===e))||void 0===t?void 0:t.EmployeeID)||"#N/A"}loadData(){return Object(R.a)(this,void 0,void 0,function*(){try{(yield this.getUsers())&&this.deliveredHistory()}catch(e){}})}deliveredHistory(){this.makeGlueService.deliveredHistory().subscribe(e=>{this.data=e.map(e=>({glueName:e.glueName,buildingName:e.buildingName,qty:e.qty,deliveredBy:this.username(e.createdBy),createdDate:new Date(e.createdDate)}))})}NO(e){return(this.grid.pageSettings.currentPage-1)*this.grid.pageSettings.pageSize+Number(e)+1}}return e.\u0275fac=function(t){return new(t||e)(M.Mb(A.a),M.Mb(N.a))},e.\u0275cmp=M.Gb({type:e,selectors:[["app-delivered-history"]],viewQuery:function(e,t){if(1&e&&M.Qc(T,!0),2&e){let e;M.xc(e=M.dc())&&(t.grid=e.first)}},features:[M.yb([D.g])],decls:15,vars:6,consts:[[1,"card"],[1,"card-body"],["gridLines","Both","allowFiltering","true","allowPaging","true","allowResizing","true","showColumnMenu","true",3,"dataSource","allowSorting","allowExcelExport","filterSettings","pageSettings","toolbar","toolbarClick"],["grid",""],["field","#","textAlign","Center","headerText","#","width","40"],["template",""],["field","glueName","textAlign","Center","headerText","Glue","width","100"],["field","buildingName","textAlign","Center","headerText","Line","width","130"],["field","qty","textAlign","Center","headerText","Qty","width","100"],["field","deliveredBy","textAlign","Center","headerText","Delivered By","width","150"],["field","createdDate","textAlign","Center","type","dateTime","format","d MMM, yyyy HH:mm","headerText","Delivered Date","width","150"]],template:function(e,t){1&e&&(M.Sb(0,"div",0),M.Sb(1,"div",1),M.Sb(2,"ejs-grid",2,3),M.cc("toolbarClick",function(e){return t.toolbarClick(e)}),M.Sb(4,"e-columns"),M.Sb(5,"e-column",4),M.Ic(6,U,1,1,"ng-template",null,5,M.Jc),M.Rb(),M.Nb(8,"e-column",6),M.Nb(9,"e-column",7),M.Sb(10,"e-column",8),M.Ic(11,k,1,1,"ng-template",null,5,M.Jc),M.Rb(),M.Nb(13,"e-column",9),M.Nb(14,"e-column",10),M.Rb(),M.Rb(),M.Rb(),M.Rb()),2&e&&(M.zb(2),M.mc("dataSource",t.data)("allowSorting",!0)("allowExcelExport",!0)("filterSettings",t.filterSettings)("pageSettings",t.pageSettings)("toolbar",t.toolbarOptions))},directives:[D.j,d.d,C.d,C.b,D.e,D.b,d.c,C.c,C.a,D.d,D.a],styles:[""]}),e})();var E=i("H552"),L=i("XNiG"),$=i("HJFG"),F=i("vrRs"),P=i("wsp1");const j=["ingredientinforeportGrid"];function J(e,t){if(1&e){const e=M.Tb();M.Sb(0,"div",5),M.Sb(1,"ejs-dropdownlist",23,24),M.cc("ngModelChange",function(t){return M.Bc(e),M.gc().buildingID=t})("filtering",function(t){return M.Bc(e),M.gc().onFilteringBuilding(t)})("change",function(t){return M.Bc(e),M.gc().onChangeBuilding(t)}),M.Rb(),M.Rb()}if(2&e){const e=M.gc();M.zb(1),M.mc("dataSource",e.buildings)("fields",e.fieldsBuildings)("allowFiltering",!0)("ngModel",e.buildingID)}}function z(e,t){1&e&&(M.Kc(0),M.hc(1,"translate")),2&e&&M.Mc(" ",M.ic(1,1,"TIME_LABEL")," ")}function G(e,t){1&e&&(M.Kc(0),M.hc(1,"date")),2&e&&M.Mc(" ",M.jc(1,1,t.$implicit.createdTime,"dd MMM, yyyy , HH:mm")," ")}function K(e,t){1&e&&(M.Kc(0),M.hc(1,"translate")),2&e&&M.Mc(" ",M.ic(1,1,"SUPPLIER")," ")}function Q(e,t){1&e&&(M.Kc(0),M.hc(1,"translate")),2&e&&M.Mc(" ",M.ic(1,1,"INGREDIENT_LABEL")," ")}function _(e,t){1&e&&(M.Kc(0),M.hc(1,"translate")),2&e&&M.Mc(" ",M.ic(1,1,"PRODUCTION_DATE_LABEL")," ")}function q(e,t){1&e&&(M.Kc(0),M.hc(1,"date")),2&e&&M.Mc(" ",M.jc(1,1,t.$implicit.manufacturingDate,"dd MMM, yyyy")," ")}function H(e,t){1&e&&(M.Kc(0),M.hc(1,"translate")),2&e&&M.Mc(" ",M.ic(1,1,"BATCH_LABEL")," ")}function W(e,t){1&e&&(M.Kc(0),M.hc(1,"translate")),2&e&&M.Mc(" ",M.ic(1,1,"EXPIRED_DATE_LABEL")," ")}function V(e,t){1&e&&(M.Kc(0),M.hc(1,"date")),2&e&&M.Mc(" ",M.jc(1,1,t.$implicit.expiredTime,"dd MMM, yyyy")," ")}function Y(e,t){1&e&&(M.Kc(0),M.hc(1,"translate")),2&e&&M.Mc(" ",M.ic(1,1,"QTY_LABEL")," ")}function X(e,t){1&e&&M.Kc(0),2&e&&M.Mc(" ",t.$implicit.qty," Kg ")}function Z(e,t){1&e&&(M.Kc(0),M.hc(1,"translate")),2&e&&M.Mc(" ",M.ic(1,1,"CONSUMPTION_LABEL")," ")}function ee(e,t){1&e&&M.Kc(0),2&e&&M.Mc(" ",t.$implicit.consumption," Kg ")}let te=(()=>{class e{constructor(e,t,i,n,a,l){this.modalService=e,this.alertify=t,this.datePipe=i,this.ingredientService=n,this.buildingService=a,this.startDate=new Date,this.endDate=new Date,this.role=JSON.parse(localStorage.getItem("level")),this.building=JSON.parse(localStorage.getItem("building")),this.toolbarOptions=["Search","ExcelExport"],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:20},this.filterSettings={type:"Excel"},this.fieldsBuildings={text:"name",value:"id"},this.data=[],this.ingredients=[],this.IsAdmin=!1,this.subject=new L.a,this.subscription=[],this.onFilteringBuilding=e=>{let t=new E.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.buildings,t)}}ngOnInit(){[1,2].includes(this.role.id)?(this.IsAdmin=!0,this.getBuilding()):this.buildingName=this.building.name}onChangeBuilding(e){this.buildingID=e.itemData.id,this.buildingName=e.itemData.name,localStorage.setItem("buildingID",e.itemData.id),this.searchWithBuilding(this.startDate,this.endDate)}getBuilding(){this.buildingService.getBuildings().subscribe(e=>Object(R.a)(this,void 0,void 0,function*(){this.buildings=e.filter(e=>2===e.level)}))}resetSearch(){this.searchText=null}toolbarClick(e){switch(e.item.text){case"Excel Export":this.ingredientinforeportGrid.excelExport()}}getIngredientInfoReport(){this.ingredientService.getAllIngredientInfo().subscribe(e=>{this.data=e})}getIngredientInfoReportByBuilding(){this.ingredientService.getAllIngredientInfoReportByBuildingName(this.buildingName).subscribe(e=>{this.data=e})}startDateOnchange(e){this.startDate=e.value,this.searchWithBuilding(this.startDate,this.endDate)}endDateOnchange(e){this.endDate=e.value,this.searchWithBuilding(this.startDate,this.endDate)}onClickDefault(){this.startDate=new Date,this.endDate=new Date,this.searchWithBuilding(this.startDate,this.endDate)}searchWithBuilding(e,t){this.ingredientService.searchInventoryByBuildingName(e.toDateString(),t.toDateString(),this.buildingName).subscribe(e=>{this.data=e})}}return e.\u0275fac=function(t){return new(t||e)(M.Mb(o.b),M.Mb($.a),M.Mb(n.d),M.Mb(F.a),M.Mb(P.a),M.Mb(n.e))},e.\u0275cmp=M.Gb({type:e,selectors:[["app-inventory"]],viewQuery:function(e,t){if(1&e&&M.Qc(j,!0),2&e){let e;M.xc(e=M.dc())&&(t.ingredientinforeportGrid=e.first)}},features:[M.yb([n.d,n.e])],decls:55,vars:14,consts:[[1,"card"],[1,"card-body"],[1,"row"],[1,"col-md-1"],[1,"font-weight-bold"],[1,"col-md-2"],[3,"value","ngModel","change","ngModelChange"],["class","col-md-2",4,"ngIf"],[1,"btn","btn-sm","btn-default",3,"click"],[1,"fa","fa-times"],[1,"col-md-12"],["allowFiltering","true","showColumnMenu","true","allowPaging","true","gridLines","Both",3,"dataSource","allowExcelExport","allowSorting","filterSettings","toolbar","pageSettings","toolbarClick"],["ingredientinforeportGrid",""],["field","createdTime","textAlign","Center","headerText","Time","width","150"],["headerTemplate",""],["template",""],["field","supplierName","textAlign","Center","headerText","Supplier","width","100"],["field","name","textAlign","Center","headerText","Ingredient","width","100"],["field","manufacturingDate","textAlign","Center","headerText","Production date","width","130"],["field","batch","textAlign","Center","headerText","Batch","width","100"],["field","expiredTime","textAlign","Center","headerText","Expired Date","width","130"],["field","qty","textAlign","Center","headerText","Recieve Qty (Kg)","width","130"],["field","consumption","textAlign","Center","headerText","Consumption","width","100"],["placeholder","Select a building",3,"dataSource","fields","allowFiltering","ngModel","ngModelChange","filtering","change"],["modelNameDropdownlist",""]],template:function(e,t){1&e&&(M.Sb(0,"div",0),M.Sb(1,"div",1),M.Sb(2,"div",2),M.Sb(3,"div",3),M.Sb(4,"div",4),M.Kc(5),M.hc(6,"translate"),M.Rb(),M.Rb(),M.Sb(7,"div",5),M.Sb(8,"ejs-datepicker",6),M.cc("change",function(e){return t.startDateOnchange(e)})("ngModelChange",function(e){return t.startDate=e}),M.Rb(),M.Rb(),M.Sb(9,"div",5),M.Sb(10,"ejs-datepicker",6),M.cc("change",function(e){return t.endDateOnchange(e)})("ngModelChange",function(e){return t.endDate=e}),M.Rb(),M.Rb(),M.Ic(11,J,3,4,"div",7),M.Sb(12,"div",5),M.Sb(13,"button",8),M.cc("click",function(){return t.onClickDefault()}),M.Nb(14,"i",9),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Sb(15,"div",1),M.Sb(16,"div",2),M.Sb(17,"div",10),M.Sb(18,"ejs-grid",11,12),M.cc("toolbarClick",function(e){return t.toolbarClick(e)}),M.Sb(20,"e-columns"),M.Sb(21,"e-column",13),M.Ic(22,z,2,3,"ng-template",null,14,M.Jc),M.Ic(24,G,2,4,"ng-template",null,15,M.Jc),M.Rb(),M.Sb(26,"e-column",16),M.Ic(27,K,2,3,"ng-template",null,14,M.Jc),M.Rb(),M.Sb(29,"e-column",17),M.Ic(30,Q,2,3,"ng-template",null,14,M.Jc),M.Rb(),M.Sb(32,"e-column",18),M.Ic(33,_,2,3,"ng-template",null,14,M.Jc),M.Ic(35,q,2,4,"ng-template",null,15,M.Jc),M.Rb(),M.Sb(37,"e-column",19),M.Ic(38,H,2,3,"ng-template",null,14,M.Jc),M.Rb(),M.Sb(40,"e-column",20),M.Ic(41,W,2,3,"ng-template",null,14,M.Jc),M.Ic(43,V,2,4,"ng-template",null,15,M.Jc),M.Rb(),M.Sb(45,"e-column",21),M.Ic(46,Y,2,3,"ng-template",null,14,M.Jc),M.Ic(48,X,1,1,"ng-template",null,15,M.Jc),M.Rb(),M.Sb(50,"e-column",22),M.Ic(51,Z,2,3,"ng-template",null,14,M.Jc),M.Ic(53,ee,1,1,"ng-template",null,15,M.Jc),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Rb()),2&e&&(M.zb(5),M.Mc("",M.ic(6,12,"FILTER_LABEL"),":"),M.zb(3),M.mc("value",t.startDate)("ngModel",t.startDate),M.zb(2),M.mc("value",t.endDate)("ngModel",t.endDate),M.zb(1),M.mc("ngIf",t.IsAdmin),M.zb(7),M.mc("dataSource",t.data)("allowExcelExport",!0)("allowSorting",!0)("filterSettings",t.filterSettings)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings))},directives:[g.a,a.g,a.j,n.n,D.j,d.d,C.d,C.b,D.e,D.b,d.c,C.c,C.a,D.d,D.a,s.c],pipes:[p.c,n.d],styles:[".search-hero[_ngcontent-%COMP%]{max-width:500px;padding-bottom:50px;margin:auto}.form-control[_ngcontent-%COMP%]{box-shadow:0 10px 40px 0 #b0c1d9}.form-control[_ngcontent-%COMP%]::-moz-placeholder{font-family:FontAwesome}.form-control[_ngcontent-%COMP%]::placeholder{font-family:FontAwesome}"]}),e})();var ie=i("0WEV");const ne=["cloneModal"],ae=["planForm"],le=["grid"];function re(e,t){if(1&e&&(M.Kc(0),M.hc(1,"date")),2&e){const e=t.$implicit;M.Mc(" ","0001-01-01T00:00:00"===e.mixingDate?"N/A":M.jc(1,1,e.mixingDate,"dd/MM/yyyy")," ")}}function se(e,t){1&e&&M.Kc(0),2&e&&M.Mc("",t.$implicit.percentage," %")}const oe=JSON.parse(localStorage.getItem("level"));let ce=(()=>{class e{constructor(e,t,i,n,a,l,r){this.route=e,this.alertify=t,this.modalService=i,this.planService=n,this.datePipe=a,this.spinner=l,this.buildingService=r,this.searchSettings={hierarchyMode:"Parent"},this.fieldsBuildings={text:"name",value:"id"},this.sortSettings={columns:[{field:"percentage",direction:"Descending"}]},this.queryCellInfoEvent=e=>{e.data.percentage>0&&(e.cell.style.backgroundColor="#FFFF66")},this.onFilteringBuilding=e=>{let t=new E.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.buildings,t)},this.buildingID=+localStorage.getItem("buildingID")}dataBound(){this.grid.autoFitColumns()}ngOnInit(){this.startDate=new Date,this.endDate=new Date,this.role=oe,this.level=JSON.parse(localStorage.getItem("level")).level,this.pageSettings={pageCount:20,pageSizes:["All",100],pageSize:100},this.toolbarOptions=["ExcelExport","Search"],this.getBuilding(0===this.buildingID?()=>{this.alertify.message("Please select a building!",!0)}:()=>{this.consumptionByLineCase1()})}headerCellInfo(e){"totalConsumption"===e.cell.column.field&&new f.a({content:"Total Consumption (kg)"}).appendTo(e.node),"realConsumption"===e.cell.column.field&&new f.a({content:"Real Consumption (g) pr."}).appendTo(e.node),"mixingDate"===e.cell.column.field&&new f.a({content:"Mixing Date Of Glue"}).appendTo(e.node)}onChangeBuilding(e){this.buildingID=e.itemData.id,localStorage.setItem("buildingID",e.itemData.id),this.consumptionByLineCase1()}onSelectBuilding(e){this.buildingID=e.itemData.id,localStorage.setItem("buildingID",e.itemData.id),this.consumptionByLineCase1()}getBuilding(e){this.buildingService.getBuildings().subscribe(t=>Object(R.a)(this,void 0,void 0,function*(){this.buildings=t.filter(e=>2===e.level),e()}))}consumptionByLineCase1(){this.planService.consumptionByLineCase1(this.buildingID,this.startDate,this.endDate).subscribe(e=>{this.data=e})}startDateOnchange(e){e.isInteracted&&(this.startDate=e.value,this.consumptionByLineCase1())}endDateOnchange(e){e.isInteracted&&(this.endDate=e.value,this.consumptionByLineCase1())}onClickDefault(){this.startDate=new Date,this.endDate=new Date,this.consumptionByLineCase1()}toolbarClick(e){-1!==e.item.id.indexOf("excelexport")&&this.reportConsumptionCase1()}tooltip(e){return e?e.join("<br>"):""}reportConsumptionCase1(){Math.floor((this.endDate.getTime()-this.startDate.getTime())/864e5)>31?this.alertify.error("Ch\u1ec9 \u0111\u01b0\u1ee3c xu\u1ea5t d\u1eef li\u1ec7u b\xe1o c\xe1o trong 30 ng\xe0y!!!<br>The report data can only be exported for 30 days!!!",!0):(this.spinner.show(),this.planService.reportConsumptionCase1(this.buildingID,this.startDate,this.endDate).subscribe(e=>{new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});const t=window.URL.createObjectURL(e),i=document.createElement("a");i.href=t;const n=new Date;i.download=`${n.getFullYear()}${n.getMonth()}${n.getDay()}_Consumption1.xlsx`,i.click(),this.spinner.hide()}))}}return e.\u0275fac=function(t){return new(t||e)(M.Mb(B.a),M.Mb($.a),M.Mb(o.b),M.Mb(ie.a),M.Mb(n.d),M.Mb(l.c),M.Mb(P.a))},e.\u0275cmp=M.Gb({type:e,selectors:[["app-consumption-1"]],viewQuery:function(e,t){if(1&e&&(M.Qc(ne,!0),M.Qc(ae,!0),M.Qc(le,!0)),2&e){let e;M.xc(e=M.dc())&&(t.cloneModal=e.first),M.xc(e=M.dc())&&(t.orderForm=e.first),M.xc(e=M.dc())&&(t.grid=e.first)}},decls:44,vars:21,consts:[["type","square-jelly-box","size","medium",3,"fullScreen"],[1,"loading"],[1,"row","pt-2"],[1,"col-md-12"],[1,"card"],[1,"card-body","p-0"],[1,"row","my-3"],[1,"row"],[1,"col-md-1"],[1,"font-weight-bold"],[1,"col-md-3"],[3,"value","ngModel","change","ngModelChange"],[1,"col-md-2"],["placeholder","Select a building",3,"dataSource","fields","allowFiltering","value","filtering","change"],["modelNameDropdownlist",""],[1,"btn","btn-sm","btn-default",3,"click"],[1,"fa","fa-times"],["gridLines","Both",3,"dataSource","searchSettings","showColumnMenu","allowPaging","allowSorting","allowResizing","toolbar","sortSettings","pageSettings","dataBound","queryCellInfo","headerCellInfo","toolbarClick"],["grid",""],["field","modelName","headerText","Model Name","width","100","textAlign","Center"],["field","modelNo","headerText","Model No.","width","100","textAlign","Center"],["field","articleNo","headerText","Article No.","width","100","textAlign","Center"],["field","process","headerText","Process","width","100","textAlign","Center"],["field","glue","headerText","Glue","width","100","textAlign","Center"],["field","std","headerText","Std.(g)","width","100","textAlign","Center"],["field","mixingDate","headerText","Mixing Date","type","date","format","dd/MM/yyyy","width","100","textAlign","Center"],["template",""],["field","line","headerText","Line","width","100","textAlign","Center"],["field","qty","headerText","Qty","width","100","textAlign","Center"],["field","totalConsumption","headerText","\u2211 Con. (kg)","width","100","textAlign","Center"],["field","realConsumption","headerText","Real Con. (g) pr.","width","100","textAlign","Center"],["field","diff","headerText","Diff.","width","100","textAlign","Center"],["field","percentage","headerText","%","width","100","textAlign","Center"]],template:function(e,t){1&e&&(M.Sb(0,"ngx-spinner",0),M.Sb(1,"p",1),M.Kc(2,"Loading data..."),M.Rb(),M.Rb(),M.Sb(3,"div",2),M.Sb(4,"div",3),M.Sb(5,"div",4),M.Sb(6,"div",5),M.Sb(7,"div",6),M.Sb(8,"div",3),M.Sb(9,"div",7),M.Sb(10,"div",8),M.Sb(11,"div",9),M.Kc(12),M.hc(13,"translate"),M.Rb(),M.Rb(),M.Sb(14,"div",10),M.Sb(15,"ejs-datepicker",11),M.cc("change",function(e){return t.startDateOnchange(e)})("ngModelChange",function(e){return t.startDate=e}),M.Rb(),M.Rb(),M.Sb(16,"div",10),M.Sb(17,"ejs-datepicker",11),M.cc("change",function(e){return t.endDateOnchange(e)})("ngModelChange",function(e){return t.endDate=e}),M.Rb(),M.Rb(),M.Sb(18,"div",12),M.Sb(19,"ejs-dropdownlist",13,14),M.cc("filtering",function(e){return t.onFilteringBuilding(e)})("change",function(e){return t.onChangeBuilding(e)}),M.Rb(),M.Rb(),M.Sb(21,"div",12),M.Sb(22,"button",15),M.cc("click",function(){return t.onClickDefault()}),M.Nb(23,"i",16),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Sb(24,"ejs-grid",17,18),M.cc("dataBound",function(){return t.dataBound()})("queryCellInfo",function(e){return t.queryCellInfoEvent(e)})("headerCellInfo",function(e){return t.headerCellInfo(e)})("toolbarClick",function(e){return t.toolbarClick(e)}),M.Sb(26,"e-columns"),M.Nb(27,"e-column",19),M.Nb(28,"e-column",20),M.Nb(29,"e-column",21),M.Nb(30,"e-column",22),M.Nb(31,"e-column",23),M.Nb(32,"e-column",24),M.Sb(33,"e-column",25),M.Ic(34,re,2,4,"ng-template",null,26,M.Jc),M.Rb(),M.Nb(36,"e-column",27),M.Nb(37,"e-column",28),M.Nb(38,"e-column",29),M.Nb(39,"e-column",30),M.Nb(40,"e-column",31),M.Sb(41,"e-column",32),M.Ic(42,se,1,1,"ng-template",null,26,M.Jc),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Rb()),2&e&&(M.mc("fullScreen",!1),M.zb(12),M.Mc("",M.ic(13,19,"FILTER_LABEL"),":"),M.zb(3),M.mc("value",t.startDate)("ngModel",t.startDate),M.zb(2),M.mc("value",t.endDate)("ngModel",t.endDate),M.zb(2),M.mc("dataSource",t.buildings)("fields",t.fieldsBuildings)("allowFiltering",!0)("value",t.buildingID),M.zb(5),M.mc("dataSource",t.data)("searchSettings",t.searchSettings)("showColumnMenu",!0)("allowPaging",!0)("allowSorting",!0)("allowResizing",!0)("toolbar",t.toolbarOptions)("sortSettings",t.sortSettings)("pageSettings",t.pageSettings))},directives:[l.a,g.a,a.g,a.j,s.c,D.j,d.d,C.d,C.b,D.e,D.b,d.c,C.c,C.a,D.d,D.a],pipes:[p.c,n.d],styles:[".bgcolor[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#ff6!important}"]}),e})();const de=["cloneModal"],ue=["planForm"],ge=["grid"];function he(e,t){if(1&e&&(M.Kc(0),M.hc(1,"date")),2&e){const e=t.$implicit;M.Mc(" ","0001-01-01T00:00:00"===e.mixingDate?"N/A":M.jc(1,1,e.mixingDate,"dd/MM/yyyy")," ")}}function be(e,t){1&e&&M.Kc(0),2&e&&M.Mc("",t.$implicit.percentage," %")}const pe=JSON.parse(localStorage.getItem("level"));let me=(()=>{class e{constructor(e,t,i,n,a,l,r){this.route=e,this.alertify=t,this.modalService=i,this.planService=n,this.datePipe=a,this.spinner=l,this.buildingService=r,this.searchSettings={hierarchyMode:"Parent"},this.fieldsBuildings={text:"name",value:"id"},this.queryCellInfoEvent=e=>{const t=e.data,i=["modelName","modelNo","articleNo","process","qty","line"];i.includes(e.column.field)&&(e.rowSpan=this.data.filter(e=>e.id===t.id&&e.modelName===t.modelName&&e.modelNo===t.modelNo&&e.articleNo===t.articleNo&&e.process===t.process&&e.line===t.line&&e.dueDate===t.dueDate&&e.qty===t.qty).length),i.includes(e.column.field)||t.percentage>0&&(e.cell.style.backgroundColor="#FFFF66")},this.onFilteringBuilding=e=>{let t=new E.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.buildings,t)},this.buildingID=+localStorage.getItem("buildingID")}dataBound(){}ngOnInit(){this.role=pe,this.startDate=new Date,this.endDate=new Date,this.level=JSON.parse(localStorage.getItem("level")).level,this.gridConfig(),this.getBuilding(0===this.buildingID?()=>{this.alertify.message("Please select a building!",!0)}:()=>{this.consumptionByLineCase2()})}gridConfig(){this.pageSettings={pageCount:20,pageSizes:["All",100],pageSize:100},this.toolbarOptions=["ExcelExport","Search"]}onChangeBuilding(e){this.buildingID=e.itemData.id,localStorage.setItem("buildingID",e.itemData.id),this.consumptionByLineCase2()}getBuilding(e){this.buildingService.getBuildings().subscribe(t=>Object(R.a)(this,void 0,void 0,function*(){this.buildings=t.filter(e=>2===e.level),e()}))}consumptionByLineCase2(){this.planService.consumptionByLineCase2(this.buildingID,this.startDate,this.endDate).subscribe(e=>{this.data=e})}startDateOnchange(e){e.isInteracted&&(this.startDate=e.value,this.consumptionByLineCase2())}endDateOnchange(e){e.isInteracted&&(this.endDate=e.value,this.consumptionByLineCase2())}onClickDefault(){this.startDate=new Date,this.endDate=new Date,this.consumptionByLineCase2()}toolbarClick(e){-1!==e.item.id.indexOf("excelexport")&&this.reportConsumptionCase2()}tooltip(e){return e?e.join("<br>"):""}reportConsumptionCase2(){Math.floor((this.endDate.getTime()-this.startDate.getTime())/864e5)>31?this.alertify.error("Ch\u1ec9 \u0111\u01b0\u1ee3c xu\u1ea5t d\u1eef li\u1ec7u b\xe1o c\xe1o trong 30 ng\xe0y!!!<br>The report data can only be exported for 30 days!!!",!0):(this.spinner.show(),this.planService.reportConsumptionCase2(this.buildingID,this.startDate,this.endDate).subscribe(e=>{new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});const t=window.URL.createObjectURL(e),i=document.createElement("a");i.href=t;const n=new Date;i.download=`${n.getFullYear()}${n.getMonth()}${n.getDay()}_Consumption2.xlsx`,i.click(),this.spinner.hide()}))}}return e.\u0275fac=function(t){return new(t||e)(M.Mb(B.a),M.Mb($.a),M.Mb(o.b),M.Mb(ie.a),M.Mb(n.d),M.Mb(l.c),M.Mb(P.a))},e.\u0275cmp=M.Gb({type:e,selectors:[["app-consumption-2"]],viewQuery:function(e,t){if(1&e&&(M.Qc(de,!0),M.Qc(ue,!0),M.Qc(ge,!0)),2&e){let e;M.xc(e=M.dc())&&(t.cloneModal=e.first),M.xc(e=M.dc())&&(t.orderForm=e.first),M.xc(e=M.dc())&&(t.grid=e.first)}},decls:43,vars:16,consts:[["type","square-jelly-box","size","medium",3,"fullScreen"],[1,"loading"],[1,"row","pt-2"],[1,"col-md-12"],[1,"card"],[1,"card-body","p-0"],[1,"row","my-3"],[1,"row"],[1,"col-md-1"],[1,"font-weight-bold"],[1,"col-md-3"],[3,"value","ngModel","change","ngModelChange"],[1,"col-md-2"],["placeholder","Select a building",3,"dataSource","fields","allowFiltering","value","filtering","change"],["modelNameDropdownlist",""],[1,"btn","btn-sm","btn-default",3,"click"],[1,"fa","fa-times"],["showColumnMenu","true","allowPaging","true","allowResizing","true","gridLines","Both",3,"dataSource","searchSettings","toolbar","pageSettings","dataBound","queryCellInfo","toolbarClick"],["grid",""],["field","line","headerText","Line","width","80","textAlign","Center"],["field","modelName","headerText","ModelName","width","120","textAlign","Center"],["field","modelNo","headerText","ModelNo","width","100","textAlign","Center"],["field","articleNo","headerText","ArticleNo","width","100","textAlign","Center"],["field","process","headerText","Process","width","100","textAlign","Center"],["field","qty","headerText","Qty","width","100","textAlign","Center"],["field","glue","headerText","Glue","width","150","textAlign","Center"],["field","std","headerText","Std.(g)","width","100","textAlign","Center"],["field","mixingDate","headerText","Mixing Date","type","date","format","dd/MM/yyyy","width","100","textAlign","Center"],["template",""],["field","realConsumption","headerText","Real Consumption (g) pr.","width","100","textAlign","Center"],["field","diff","headerText","Diff","width","100","textAlign","Center"],["field","percentage","headerText","%","width","100","textAlign","Center"]],template:function(e,t){1&e&&(M.Sb(0,"ngx-spinner",0),M.Sb(1,"p",1),M.Kc(2,"Loading data..."),M.Rb(),M.Rb(),M.Sb(3,"div",2),M.Sb(4,"div",3),M.Sb(5,"div",4),M.Sb(6,"div",5),M.Sb(7,"div",6),M.Sb(8,"div",3),M.Sb(9,"div",7),M.Sb(10,"div",8),M.Sb(11,"div",9),M.Kc(12),M.hc(13,"translate"),M.Rb(),M.Rb(),M.Sb(14,"div",10),M.Sb(15,"ejs-datepicker",11),M.cc("change",function(e){return t.startDateOnchange(e)})("ngModelChange",function(e){return t.startDate=e}),M.Rb(),M.Rb(),M.Sb(16,"div",10),M.Sb(17,"ejs-datepicker",11),M.cc("change",function(e){return t.endDateOnchange(e)})("ngModelChange",function(e){return t.endDate=e}),M.Rb(),M.Rb(),M.Sb(18,"div",12),M.Sb(19,"ejs-dropdownlist",13,14),M.cc("filtering",function(e){return t.onFilteringBuilding(e)})("change",function(e){return t.onChangeBuilding(e)}),M.Rb(),M.Rb(),M.Sb(21,"div",12),M.Sb(22,"button",15),M.cc("click",function(){return t.onClickDefault()}),M.Nb(23,"i",16),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Sb(24,"ejs-grid",17,18),M.cc("dataBound",function(){return t.dataBound()})("queryCellInfo",function(e){return t.queryCellInfoEvent(e)})("toolbarClick",function(e){return t.toolbarClick(e)}),M.Sb(26,"e-columns"),M.Nb(27,"e-column",19),M.Nb(28,"e-column",20),M.Nb(29,"e-column",21),M.Nb(30,"e-column",22),M.Nb(31,"e-column",23),M.Nb(32,"e-column",24),M.Nb(33,"e-column",25),M.Nb(34,"e-column",26),M.Sb(35,"e-column",27),M.Ic(36,he,2,4,"ng-template",null,28,M.Jc),M.Rb(),M.Nb(38,"e-column",29),M.Nb(39,"e-column",30),M.Sb(40,"e-column",31),M.Ic(41,be,1,1,"ng-template",null,28,M.Jc),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Rb()),2&e&&(M.mc("fullScreen",!1),M.zb(12),M.Mc("",M.ic(13,14,"FILTER_LABEL"),":"),M.zb(3),M.mc("value",t.startDate)("ngModel",t.startDate),M.zb(2),M.mc("value",t.endDate)("ngModel",t.endDate),M.zb(2),M.mc("dataSource",t.buildings)("fields",t.fieldsBuildings)("allowFiltering",!0)("value",t.buildingID),M.zb(5),M.mc("dataSource",t.data)("searchSettings",t.searchSettings)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings))},directives:[l.a,g.a,a.g,a.j,s.c,D.j,d.d,C.d,C.b,D.e,D.b,d.c,C.c,C.a,D.d,D.a],pipes:[p.c,n.d],styles:[".bgcolor[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#ff6!important}"]}),e})();var fe=i("t0UR");const Se=["cloneModal"],De=["planForm"],ye=["grid"];function we(e,t){if(1&e){const e=M.Tb();M.Sb(0,"div",18),M.Sb(1,"div",3),M.Sb(2,"div",19),M.Sb(3,"div",20),M.Sb(4,"div",21),M.Sb(5,"div",22),M.Kc(6),M.hc(7,"translate"),M.Rb(),M.Rb(),M.Sb(8,"div",23),M.Sb(9,"ejs-datepicker",24),M.cc("change",function(t){return M.Bc(e),M.gc().startDateOnchange(t)})("ngModelChange",function(t){return M.Bc(e),M.gc().startDate=t}),M.Rb(),M.Rb(),M.Sb(10,"div",23),M.Sb(11,"ejs-datepicker",24),M.cc("change",function(t){return M.Bc(e),M.gc().endDateOnchange(t)})("ngModelChange",function(t){return M.Bc(e),M.gc().endDate=t}),M.Rb(),M.Rb(),M.Sb(12,"div",25),M.Sb(13,"ejs-dropdownlist",26,27),M.cc("ngModelChange",function(t){return M.Bc(e),M.gc().buildingID=t})("filtering",function(t){return M.Bc(e),M.gc().onFilteringBuilding(t)})("select",function(t){return M.Bc(e),M.gc().onSelectBuilding(t)}),M.Rb(),M.Rb(),M.Sb(15,"div",25),M.Sb(16,"button",28),M.cc("click",function(){return M.Bc(e),M.gc().onClickDefault()}),M.Nb(17,"i",29),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Rb()}if(2&e){const e=M.gc();M.zb(6),M.Mc("",M.ic(7,9,"FILTER_LABEL"),":"),M.zb(3),M.mc("value",e.startDate)("ngModel",e.startDate),M.zb(2),M.mc("value",e.endDate)("ngModel",e.endDate),M.zb(2),M.mc("dataSource",e.buildings)("fields",e.fieldsBuildings)("allowFiltering",!0)("ngModel",e.buildingID)}}function Ce(e,t){1&e&&(M.Kc(0),M.hc(1,"translate")),2&e&&M.Mc(" ",M.ic(1,1,"LINE_LABEL")," ")}function ve(e,t){1&e&&M.Kc(0),2&e&&M.Mc(" ",t.$implicit.buildingName," ")}function xe(e,t){1&e&&(M.Kc(0),M.hc(1,"translate")),2&e&&M.Mc(" ",M.ic(1,1,"BPFC_NAME_LABEL")," ")}function Ie(e,t){1&e&&M.Kc(0),2&e&&M.Mc(" ",t.$implicit.bpfcName," ")}function Be(e,t){if(1&e&&(M.Sb(0,"ejs-tooltip",30),M.Kc(1),M.Rb()),2&e){const e=t.$implicit,i=M.gc();M.mc("content",i.tooltip(e.glues)),M.zb(1),M.Mc(" ",e.bpfcName||"#N/A"," ")}}function Re(e,t){1&e&&(M.Kc(0),M.hc(1,"translate")),2&e&&M.Mc(" ",M.ic(1,1,"OUTPUT_QUANTITY")," ")}function Me(e,t){1&e&&(M.Kc(0),M.hc(1,"translate")),2&e&&M.Mc(" ",M.ic(1,1,"DUE_DATE_LABEL")," ")}function Ae(e,t){1&e&&(M.Kc(0),M.hc(1,"date")),2&e&&M.Mc(" ",M.jc(1,1,t.$implicit.dueDate,"dd MMM, yyyy")," ")}function Ne(e,t){1&e&&(M.Kc(0),M.hc(1,"translate")),2&e&&M.Mc(" ",M.ic(1,1,"CREATED_DATE_LABEL")," ")}function Te(e,t){1&e&&(M.Kc(0),M.hc(1,"date")),2&e&&M.Mc(" ",M.jc(1,1,t.$implicit.createdDate,"dd MMM, yyyy HH:mm")," ")}function Ue(e,t){if(1&e){const e=M.Tb();M.Sb(0,"div",31),M.Sb(1,"h4",32),M.Nb(2,"i",33),M.Kc(3," Clone Work Plan "),M.Rb(),M.Sb(4,"button",34),M.cc("click",function(){return t.$implicit.dismiss("Cross click")}),M.Sb(5,"span",35),M.Kc(6,"\xd7"),M.Rb(),M.Rb(),M.Rb(),M.Sb(7,"div",36),M.Sb(8,"div",20),M.Sb(9,"div",3),M.Sb(10,"div",37),M.Sb(11,"label",38),M.Kc(12,"DueDate"),M.Rb(),M.Sb(13,"span",39),M.Kc(14,"(*)"),M.Rb(),M.Sb(15,"ejs-datepicker",40),M.cc("change",function(t){return M.Bc(e),M.gc().onChangeDueDateClone(t)}),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Sb(16,"div",41),M.Sb(17,"button",42),M.cc("click",function(){return t.$implicit.close("Close click")}),M.Kc(18,"Close"),M.Rb(),M.Sb(19,"button",43),M.cc("click",function(){return M.Bc(e),M.gc().onClickClone()}),M.Kc(20,"Clone"),M.Rb(),M.Rb()}if(2&e){const e=M.gc();M.zb(15),M.mc("value",e.date)}}const ke=[{path:"",data:{title:"Report",breadcrumb:"Report"},children:[{path:"consumption",component:(()=>{class e{constructor(e,t,i,n,a,l,r,s){this.route=e,this.alertify=t,this.modalService=i,this.planService=n,this.bPFCEstablishService=a,this.datePipe=l,this.buildingService=r,this.spinner=s,this.startDate=new Date,this.endDate=new Date,this.sortSettings={columns:[{field:"dueDate",direction:"Ascending"}]},this.date=new Date,this.role=JSON.parse(localStorage.getItem("level")),this.building=JSON.parse(localStorage.getItem("building")),this.searchSettings={hierarchyMode:"Parent"},this.modalPlan={id:0,buildingID:0,BPFCEstablishID:0,BPFCName:"",hourlyOutput:0,workingHour:0,dueDate:new Date,startWorkingTime:new Date,finishWorkingTime:new Date,startTime:{hour:7,minute:0},endTime:{hour:16,minute:30}},this.textLine="Select a line name",this.fieldsGlue={text:"name",value:"name"},this.fieldsLine={text:"name",value:"name"},this.fieldsBPFC={text:"name",value:"name"},this.fieldsBuildings={text:"name",value:"id"},this.buildingID=0,this.onFilteringBuilding=e=>{let t=new E.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.buildings,t)}}ngOnInit(){new Date,this.endDate=new Date,this.level=JSON.parse(localStorage.getItem("level")).level,this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.editparams={params:{popupHeight:"300px"}},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!1,allowAdding:!1,allowDeleting:!1,mode:"Normal"},this.toolbarOptions=[{text:"Report",tooltipText:"Report",prefixIcon:"e-excelexport",id:"report"},{text:"Report(new)",tooltipText:"Report(new)",prefixIcon:"e-excelexport",id:"newReport"},"Search"],this.getAll(this.startDate,this.endDate),this.getAllBPFC();const e=JSON.parse(localStorage.getItem("level")).id;this.getAllLine(e),this.getBuilding(),this.ClearForm()}onSelectBuilding(e){this.buildingID=e.itemData.id,localStorage.setItem("buildingID",e.itemData.id),this.getAll(this.startDate,this.endDate)}getBuilding(){this.buildingService.getBuildings().subscribe(e=>Object(R.a)(this,void 0,void 0,function*(){this.buildings=e.filter(e=>2===e.level)}))}count(e){return Number(e)+1}getAllLine(e){this.planService.getLines(e).subscribe(e=>{this.buildingName=e})}getReport(e){Math.floor((e.endDate.getTime()-e.startDate.getTime())/864e5)>31?this.alertify.error("Ch\u1ec9 \u0111\u01b0\u1ee3c xu\u1ea5t d\u1eef li\u1ec7u b\xe1o c\xe1o trong 30 ng\xe0y!!!<br>The report data can only be exported for 30 days!!!",!0):(this.spinner.show(),this.planService.getReport(e).subscribe(e=>{new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});const t=window.URL.createObjectURL(e),i=document.createElement("a");i.href=t;const n=new Date;i.download=`${n.getFullYear()}${n.getMonth()}${n.getDay()}_Cost.xlsx`,i.click(),this.spinner.hide()}))}getReportByBuilding(){const e={startDate:this.startDate,endDate:this.endDate,buildingID:this.buildingID};Math.floor((e.endDate.getTime()-e.startDate.getTime())/864e5)>31?this.alertify.error("Ch\u1ec9 \u0111\u01b0\u1ee3c xu\u1ea5t d\u1eef li\u1ec7u b\xe1o c\xe1o trong 30 ng\xe0y!!!<br>The report data can only be exported for 30 days!!!",!0):(this.spinner.show(),this.planService.getReportByBuilding(e).subscribe(e=>{new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});const t=window.URL.createObjectURL(e),i=document.createElement("a");i.href=t;const n=new Date;i.download=`${n.getFullYear()}${n.getMonth()}${n.getDay()}_Cost.xlsx`,i.click(),this.spinner.hide()}))}downLoadFile(e,t){const i=new Blob([e],{type:t}),n=window.URL.createObjectURL(i),a=window.open(n);a&&!a.closed&&void 0!==a.closed||this.alertify.error("Please disable your Pop-up blocker and try again."),this.spinner.hide()}onChangeBuildingNameEdit(e){this.buildingNameEdit=e.itemData.id}onChangeDueDateEdit(e){this.dueDate=e.value.toDateString()}onChangeDueDateClone(e){this.date=e.value}onChangeBPFCEdit(e){this.bpfcEdit=e.itemData.id}actionComplete(e){"beginEdit"===e.requestType&&e.form.elements.namedItem(this.setFocus.field).focus()}onDoubleClick(e){this.setFocus=e.column}actionBegin(e){"cancel"===e.requestType&&this.ClearForm(),"save"===e.requestType&&"edit"===e.action&&this.planService.editQuantity(e.data.id||0,e.data.quantity).subscribe(e=>{this.alertify.success("Updated succeeded!"),this.ClearForm(),this.getAll(this.startDate,this.endDate)})}ClearForm(){this.bpfcEdit=0,this.hourlyOutput=0,this.workHour=0,this.dueDate=new Date}validForm(){return[this.bpfcEdit].every(e=>e>0)}onChangeWorkingHour(e){this.workHour=e}onChangeHourlyOutput(e){this.hourlyOutput=e}rowSelected(e){}openaddModalPlan(e){this.modalReference=this.modalService.open(e)}getAllBPFC(){this.bPFCEstablishService.filterByApprovedStatus().subscribe(e=>{this.BPFCs=e.map(e=>({id:e.id,name:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`}))})}getAll(e,t){this.planService.search(this.buildingID,e.toDateString(),t.toDateString()).subscribe(e=>{this.data=e.map(e=>({id:e.id,bpfcName:`${e.modelName} - ${e.modelNoName} - ${e.articleName} - ${e.processName}`,dueDate:e.dueDate,createdDate:e.createdDate,workingHour:e.workingHour,hourlyOutput:e.hourlyOutput,buildingName:e.buildingName,buildingID:e.buildingID,quantity:e.quantity,bpfcEstablishID:e.bpfcEstablishID,glues:e.glues||[]}))})}deleteRange(e){this.alertify.confirm("Delete Plan","Are you sure you want to delete this Plans ?",()=>{this.planService.deleteRange(e).subscribe(()=>{this.getAll(this.startDate,this.endDate),this.alertify.success("Plans has been deleted")},e=>{this.alertify.error("Failed to delete the Modal Name")})})}openModal(e){const t=this.grid.getSelectedRecords();0!==t.length?(this.plansSelected=t.map(e=>({id:0,bpfcEstablishID:e.bpfcEstablishID,workingHour:e.workingHour,hourlyOutput:e.hourlyOutput,dueDate:e.dueDate,buildingID:e.buildingID})),this.modalReference=this.modalService.open(e)):this.alertify.warning("Please select the plan")}toolbarClick(e){switch(-1!==e.item.id.indexOf("excelexport")&&this.getReport({startDate:this.startDate,endDate:this.endDate}),e.item.id){case"Clone":this.openModal(this.cloneModal);break;case"Delete Range":if(0===this.grid.getSelectedRecords().length)this.alertify.warning("Please select the plans!!");else{const e=this.grid.getSelectedRecords().map(e=>e.id);this.deleteRange(e)}break;case"report":this.getReportByBuilding();break;case"newReport":this.getNewReportByBuilding()}}getNewReportByBuilding(){const e={startDate:this.startDate,endDate:this.endDate,buildingID:this.buildingID};Math.floor((e.endDate.getTime()-e.startDate.getTime())/864e5)>31?this.alertify.error("Ch\u1ec9 \u0111\u01b0\u1ee3c xu\u1ea5t d\u1eef li\u1ec7u b\xe1o c\xe1o trong 30 ng\xe0y!!!<br>The report data can only be exported for 30 days!!!",!0):(this.spinner.show(),this.planService.getNewReportByBuilding(e).subscribe(e=>{new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});const t=window.URL.createObjectURL(e),i=document.createElement("a");i.href=t;const n=new Date;i.download=`${n.getFullYear()}${n.getMonth()}${n.getDay()}_Cost(new).xlsx`,i.click(),this.spinner.hide()}))}onClickClone(){this.plansSelected.map(e=>{e.dueDate=this.date}),this.planService.clonePlan(this.plansSelected).subscribe(e=>{e?(this.alertify.success("Successfully!"),this.startDate=this.date,this.endDate=this.date,this.getAll(this.date,this.date),this.modalService.dismissAll()):(this.alertify.warning("the plans have already existed!"),this.modalService.dismissAll())})}search(e,t){this.planService.search(this.building.id,e.toDateString(),t.toDateString()).subscribe(e=>{this.data=e.map(e=>({id:e.id,bpfcName:`${e.modelName} - ${e.modelNoName} - ${e.articleName} - ${e.processName}`,dueDate:e.dueDate,createdDate:e.createdDate,workingHour:e.workingHour,hourlyOutput:e.hourlyOutput,buildingName:e.buildingName,buildingID:e.buildingID,bpfcEstablishID:e.bpfcEstablishID,quantity:e.quantity,glues:e.glues||[]}))})}onClickDefault(){this.startDate=new Date,this.endDate=new Date,this.getAll(this.startDate,this.endDate)}startDateOnchange(e){this.startDate=e.value,this.getAll(this.startDate,this.endDate)}endDateOnchange(e){this.endDate=e.value,this.getAll(this.startDate,this.endDate)}tooltip(e){return e?e.join("<br>"):""}editQuantity(e,t){this.planService.editQuantity(e,t)}onClickFilter(){this.getAll(this.startDate,this.endDate)}}return e.\u0275fac=function(t){return new(t||e)(M.Mb(B.a),M.Mb($.a),M.Mb(o.b),M.Mb(ie.a),M.Mb(fe.a),M.Mb(n.d),M.Mb(P.a),M.Mb(l.c))},e.\u0275cmp=M.Gb({type:e,selectors:[["app-consumption"]],viewQuery:function(e,t){if(1&e&&(M.Qc(Se,!0),M.Qc(De,!0),M.Qc(ye,!0)),2&e){let e;M.xc(e=M.dc())&&(t.cloneModal=e.first),M.xc(e=M.dc())&&(t.orderForm=e.first),M.xc(e=M.dc())&&(t.grid=e.first)}},decls:38,vars:9,consts:[["type","square-jelly-box","size","medium",3,"fullScreen"],[1,"loading"],[1,"row","pt-2"],[1,"col-md-12"],[1,"card"],[1,"card-body","table-responsive","p-0"],["class","row my-3",4,"ngIf"],["showColumnMenu","true","allowPaging","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"dataSource","searchSettings","allowExcelExport","sortSettings","toolbar","pageSettings","editSettings","actionBegin","actionComplete","recordDoubleClick","rowSelected","toolbarClick"],["grid",""],["field","buildingName","headerText","Line","width","100","textAlign","Center"],["headerTemplate",""],["editTemplate",""],["field","bpfcName","headerText","BPFC Name","width","290","textAlign","Center"],["template",""],["field","quantity","headerText","Quantity","width","170","textAlign","Center"],["field","dueDate","type","date","format","dd MMM, yyyy","headerText","Due Date","width","160","textAlign","Center"],["field","createdDate","isPrimaryKey","true","type","date","format","dd MMM, yyyy HH:mm","headerText","Created Date","width","200","textAlign","Center"],["cloneModal",""],[1,"row","my-3"],[1,"col-md-8"],[1,"row"],[1,"col-md-1"],[1,"font-weight-bold"],[1,"col-md-3"],[3,"value","ngModel","change","ngModelChange"],[1,"col-md-2"],["placeholder","Select a building",3,"dataSource","fields","allowFiltering","ngModel","ngModelChange","filtering","select"],["modelNameDropdownlist",""],[1,"btn","btn-sm","btn-default",3,"click"],[1,"fa","fa-times"],[3,"content"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group"],["for","Name"],[2,"color","red"],["format","dd MMM, yyyy",3,"value","change"],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(M.Sb(0,"ngx-spinner",0),M.Sb(1,"p",1),M.Kc(2,"Loading data..."),M.Rb(),M.Rb(),M.Sb(3,"div",2),M.Sb(4,"div",3),M.Sb(5,"div",4),M.Sb(6,"div",5),M.Ic(7,we,18,11,"div",6),M.Sb(8,"ejs-grid",7,8),M.cc("actionBegin",function(e){return t.actionBegin(e)})("actionComplete",function(e){return t.actionComplete(e)})("recordDoubleClick",function(e){return t.onDoubleClick(e)})("rowSelected",function(e){return t.rowSelected(e)})("toolbarClick",function(e){return t.toolbarClick(e)}),M.Sb(10,"e-columns"),M.Sb(11,"e-column",9),M.Ic(12,Ce,2,3,"ng-template",null,10,M.Jc),M.Ic(14,ve,1,1,"ng-template",null,11,M.Jc),M.Rb(),M.Sb(16,"e-column",12),M.Ic(17,xe,2,3,"ng-template",null,10,M.Jc),M.Ic(19,Ie,1,1,"ng-template",null,11,M.Jc),M.Ic(21,Be,2,2,"ng-template",null,13,M.Jc),M.Rb(),M.Sb(23,"e-column",14),M.Ic(24,Re,2,3,"ng-template",null,10,M.Jc),M.Rb(),M.Sb(26,"e-column",15),M.Ic(27,Me,2,3,"ng-template",null,10,M.Jc),M.Ic(29,Ae,2,4,"ng-template",null,11,M.Jc),M.Rb(),M.Sb(31,"e-column",16),M.Ic(32,Ne,2,3,"ng-template",null,10,M.Jc),M.Ic(34,Te,2,4,"ng-template",null,11,M.Jc),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Rb(),M.Ic(36,Ue,21,1,"ng-template",null,17,M.Jc)),2&e&&(M.mc("fullScreen",!1),M.zb(7),M.mc("ngIf",!t.hasWorker),M.zb(1),M.mc("dataSource",t.data)("searchSettings",t.searchSettings)("allowExcelExport",!0)("sortSettings",t.sortSettings)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("editSettings",t.editSettings))},directives:[l.a,n.n,D.j,d.d,C.d,C.b,D.e,D.b,d.c,C.c,C.a,D.d,D.a,g.a,a.g,a.j,s.c,f.b],pipes:[p.c,n.d],styles:[""]}),e})(),data:{title:"Cost",breadcrumb:"Cost"}},{path:"consumption-1",component:ce,data:{title:"Consumption 1",breadcrumb:"Consumption 1"}},{path:"consumption-2",component:me,data:{title:"Consumption 2",breadcrumb:"Consumption 2"}},{path:"delivered-history",component:O,data:{title:"Delivered History",breadcrumb:"Delivered History"}},{path:"inventory",component:te,data:{title:"Inventory",breadcrumb:"Inventory"}}]}];let Oe,Ee=(()=>{class e{}return e.\u0275mod=M.Kb({type:e}),e.\u0275inj=M.Jb({factory:function(t){return new(t||e)},imports:[[B.f.forChild(ke)],B.f]}),e})();function Le(e){return new m.a(e,"./assets/i18n/",".json")}const $e=localStorage.getItem("lang");Object(y.bb)(i("2PVe"),i("GFvd"),i("GFWS"),i("0zpJ"),i("LRxf")),Object(y.bb)(i("2PVe"),i("oP7I"),i("Joj5"),i("3JeS"),i("LRxf")),Oe="vi"===$e?$e:"en";let Fe=(()=>{class e{constructor(){"vi"===$e?(Oe="vi",setTimeout(()=>{y.p.load(i("+7Wi")),Object(y.nb)("vi")})):(Oe="en",setTimeout(()=>{y.p.load(i("oyrQ")),Object(y.nb)("en")}))}}return e.\u0275mod=M.Kb({type:e}),e.\u0275inj=M.Jb({factory:function(t){return new(t||e)},providers:[n.d],imports:[[I.b,u.c,n.b,a.c,a.m,l.b,Ee,r.a,s.d,o.c,d.b,d.a,d.e,c.a,c.d,c.c,u.j,h.a,g.b,C.h,D.i,u.h,f.c,x.b,S.a,g.d,v.a,w.d,u.f,s.f,p.b.forChild({loader:{provide:p.a,useFactory:Le,deps:[b.b]},defaultLanguage:Oe})]]}),e})()},"h9f+":function(e,t,i){"use strict";i.d(t,"a",function(){return c});var n=i("2Vo4"),a=i("lJxs"),l=i("tk/3"),r=i("AytR"),s=i("2zK7"),o=i("fXoL");new l.e({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")});let c=(()=>{class e{constructor(e){this.http=e,this.baseUrl=r.a.apiUrlEC,this.authUrl=r.a.apiUrl,this.messageSource=new n.a(0),this.currentMessage=this.messageSource.asObservable()}changeMessage(e){this.messageSource.next(e)}getBuildingsAsTreeView(){return this.http.get(this.baseUrl+"Building/GetAllAsTreeView")}mappingUserWithBuilding(e){return this.http.post(this.baseUrl+"BuildingUser/MappingUserWithBuilding",e)}removeBuildingUser(e){return this.http.post(this.baseUrl+"BuildingUser/RemoveBuildingUser",e)}getAllUsers(e,t){const i=new s.a;return this.http.get(`${this.authUrl}Users/GetAllUsers/${r.a.systemCode}/${e}/${t}`,{observe:"response"}).pipe(Object(a.a)(e=>(i.result=e.body,null!=e.headers.get("Pagination")&&(i.pagination=JSON.parse(e.headers.get("Pagination"))),i)))}deleteUser(e){return this.http.delete(`${this.authUrl}Users/Delete/${e}`)}updateUser(e){return this.http.post(this.authUrl+"Users/Update",e)}createUser(e){return this.http.post(this.authUrl+"Users/Create",e)}getAllBuildingUsers(){return this.http.get(this.baseUrl+"BuildingUser/getAllBuildingUsers")}getBuildingUserByBuildingID(e){return this.http.get(`${this.baseUrl}BuildingUser/GetBuildingUserByBuildingID/${e}`)}}return e.\u0275fac=function(t){return new(t||e)(o.Zb(l.b))},e.\u0275prov=o.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},mrSG:function(e,t,i){"use strict";function n(e,t,i,n){return new(i||(i=Promise))(function(a,l){function r(e){try{o(n.next(e))}catch(t){l(t)}}function s(e){try{o(n.throw(e))}catch(t){l(t)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}o((n=n.apply(e,t||[])).next())})}i.d(t,"a",function(){return n})},vrRs:function(e,t,i){"use strict";i.d(t,"a",function(){return c});var n=i("tk/3"),a=i("2Vo4"),l=i("lJxs"),r=i("AytR"),s=i("2zK7"),o=i("fXoL");new n.e({"Content-Type":"application/json"});let c=(()=>{class e{constructor(e){this.http=e,this.baseUrl=r.a.apiUrlEC,this.ingredientSource=new a.a(0),this.currentIngredient=this.ingredientSource.asObservable()}getIngredients(e,t){const i=new s.a;let a=new n.f;return null!=e&&null!=t&&(a=a.append("pageNumber",e),a=a.append("pageSize",t)),this.http.get(this.baseUrl+"ingredient/getingredients",{observe:"response",params:a}).pipe(Object(l.a)(e=>(i.result=e.body,null!=e.headers.get("Pagination")&&(i.pagination=JSON.parse(e.headers.get("Pagination"))),i)))}search(e,t,i){const a=new s.a;let r=new n.f;return null!=e&&null!=t&&(r=r.append("pageNumber",e),r=r.append("pageSize",t)),this.http.get(this.baseUrl+"ingredient/Search/"+i,{observe:"response",params:r}).pipe(Object(l.a)(e=>(a.result=e.body,null!=e.headers.get("Pagination")&&(a.pagination=JSON.parse(e.headers.get("Pagination"))),a)))}getAllIngredient(){return this.http.get(this.baseUrl+"ingredient/GetAll",{})}getAllGlueType(){return this.http.get(this.baseUrl+"ingredient/GetAllGlueType",{})}getByID(e){return this.http.get(this.baseUrl+"ingredient/GetbyID/"+e,{})}scanQRCode(e){return this.http.get(this.baseUrl+"ingredient/ScanQRCode/"+e,{})}scanQRCodeFromChemicalWareHouse(e,t,i){return this.http.get(`${this.baseUrl}ingredient/ScanQRCodeFromChemialWareHouse/${e}/${t}/${i}`,{})}scanQRCodeOutput(e,t,i){return this.http.get(`${this.baseUrl}ingredient/ScanQRCodeOutput/${e}/${t}/${i}`,{})}getAllSupplier(){return this.http.get(this.baseUrl+"Suppier/GetAll",{})}getAllIngredientInfo(){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfo",{})}getAllIngredientInfoOutput(){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoOutPut",{})}getAllIngredientInfoByBuildingName(e){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoByBuildingName/"+e,{})}getAllIngredientInfoReport(){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoReport",{})}getAllIngredientInfoReportByBuildingName(e){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoReportByBuildingName/"+e,{})}searchInventory(e,t){return this.http.get(`${this.baseUrl}ingredient/Search/${e}/${t}`,{})}searchInventoryByBuildingName(e,t,i){return this.http.get(`${this.baseUrl}ingredient/SearchWithBuildingName/${e}/${t}/${i}`,{})}deleteIngredientInfo(e,t,i,n){return this.http.delete(this.baseUrl+`ingredient/DeleteIngredientInfo/${e}/${t}/${i}/${n}`)}UpdateConsumption(e,t,i){return this.http.post(this.baseUrl+`ingredient/UpdateConsumptionIngredientReport/${e}/${t}/${i}`,{})}UpdateConsumptionOfBuilding(e){return this.http.post(this.baseUrl+"ingredient/UpdateConsumptionOfBuildingIngredientReport",e)}createSub(e){return this.http.post(this.baseUrl+"suppier/create",e)}updateSub(e){return this.http.put(this.baseUrl+"suppier/update",e)}deleteSub(e){return this.http.delete(this.baseUrl+"suppier/delete/"+e)}sortBySup(e,t){return this.http.get(this.baseUrl+`GlueIngredient/GetIngredientsByGlueID/${e}/${t}`)}getIngredientsByGlueID(e){return this.http.get(this.baseUrl+"GlueIngredient/GetIngredientsByGlueID/"+e)}create(e){return this.http.post(this.baseUrl+"ingredient/create1",e)}update(e){return this.http.put(this.baseUrl+"ingredient/update",e)}delete(e){return this.http.delete(this.baseUrl+"ingredient/delete/"+e)}changeIngredient(e){this.ingredientSource.next(e)}import(e,t){const i=new FormData;return i.append("UploadedFile",e),i.append("CreatedBy",t),this.http.post(this.baseUrl+"ingredient/Import",i)}downloadFile(){return this.http.post(this.baseUrl+"ingredient/ExcelExport",{})}GetQrcodeByid(e){return this.http.get(this.baseUrl+"ingredient/GetbyID/"+e)}UpdatePrint(e){return this.http.put(this.baseUrl+"ingredient/UpdatePrint",e)}checkIncoming(e,t,i){return this.http.get(`${this.baseUrl}ingredient/CheckIncoming/${e}/${t}/${i}`,{})}getAllIngredientInfoByBuilding(e){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoByBuilding/"+e,{})}getAllIngredientInfoOutputByBuilding(e){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoOutputByBuilding/"+e,{})}}return e.\u0275fac=function(t){return new(t||e)(o.Zb(n.b))},e.\u0275prov=o.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},wsp1:function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i("2Vo4"),a=i("tk/3"),l=i("AytR"),r=i("fXoL");new a.e({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")});let s=(()=>{class e{constructor(e){this.http=e,this.baseUrl=l.a.apiUrlEC,this.messageSource=new n.a(0),this.currentMessage=this.messageSource.asObservable()}changeMessage(e){this.messageSource.next(e)}delete(e){return this.http.delete(`${this.baseUrl}Building/Delete/${e}`)}rename(e){return this.http.put(this.baseUrl+"Building/Update",e)}getBuildingsAsTreeView(){return this.http.get(this.baseUrl+"Building/GetAllAsTreeView")}getBuildings(){return this.http.get(this.baseUrl+"Building/GetBuildings")}getAllBuildingType(){return this.http.get(this.baseUrl+"Building/getAllBuildingType")}getBuildingsForSetting(){return this.http.get(this.baseUrl+"Building/GetBuildingsForSetting")}addOrUpdateLunchTime(e){return this.http.post(this.baseUrl+"Building/AddOrUpdateLunchTime",e)}createMainBuilding(e){return this.http.post(this.baseUrl+"Building/CreateMainBuilding",e)}createSubBuilding(e){return this.http.post(this.baseUrl+"Building/CreateSubBuilding",e)}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(a.b))},e.\u0275prov=r.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);